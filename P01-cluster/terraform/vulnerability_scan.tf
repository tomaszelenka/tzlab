
#RECIPE
resource "oci_vulnerability_scanning_host_scan_recipe" "daily" {

  compartment_id = var.compartment_ocid
  display_name   = "host-daily"

  agent_settings {
    scan_level = "STANDARD" # "STRICT" / "LIGHTWEIGHT"
  }

  port_settings {
    scan_level = "STANDARD" # "STRICT" / "NONE"
  }

  schedule {
    type = "DAILY" # WEEKLY
  }

}

#TARGET
resource "oci_vulnerability_scanning_host_scan_target" "cluster" {
  compartment_id        = var.compartment_ocid
  display_name          = "cluster-target"
  host_scan_recipe_id   = oci_vulnerability_scanning_host_scan_recipe.daily.id
  target_compartment_id = var.compartment_ocid

  # EACH NODE
  instance_ids = [for inst in oci_core_instance.node : inst.id]
}
